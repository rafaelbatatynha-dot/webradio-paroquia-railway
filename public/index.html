    <!DOCTYPE html>
    <html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>WebR√°dio Par√≥quia Nossa Senhora Auxiliadora ‚Äì Ira√≠/RS</title>
        <meta name="description" content="Ou√ßa a WebR√°dio da Par√≥quia Nossa Senhora Auxiliadora de Ira√≠/RS. Programa√ß√£o cat√≥lica, mensagens do C√¥nego Rafael e m√∫sica cl√°ssica.">
        <meta name="keywords" content="WebR√°dio, Par√≥quia, Nossa Senhora Auxiliadora, Ira√≠, RS, Igreja Cat√≥lica, C√¥nego Rafael, Missa, M√∫sica Cl√°ssica, R√°dio Cat√≥lica">
        <meta name="author" content="Par√≥quia Nossa Senhora Auxiliadora">
        <link rel="canonical" href="https://www.paroquiaauxiliadorairai.com.br">

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.paroquiaauxiliadorairai.com.br">
        <meta property="og:title" content="WebR√°dio Par√≥quia Nossa Senhora Auxiliadora ‚Äì Ira√≠/RS">
        <meta property="og:description" content="Ou√ßa a WebR√°dio da Par√≥quia Nossa Senhora Auxiliadora de Ira√≠/RS. Programa√ß√£o cat√≥lica, mensagens do C√¥nego Rafael e m√∫sica cl√°ssica.">
        <meta property="og:image" content="https://www.paroquiaauxiliadorairai.com.br/images/og-image.jpg"> <!-- Substitua pela URL da sua imagem -->

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://www.paroquiaauxiliadorairai.com.br">
        <meta property="twitter:title" content="WebR√°dio Par√≥quia Nossa Senhora Auxiliadora ‚Äì Ira√≠/RS">
        <meta property="twitter:description" content="Ou√ßa a WebR√°dio da Par√≥quia Nossa Senhora Auxiliadora de Ira√≠/RS. Programa√ß√£o cat√≥lica, mensagens do C√¥nego Rafael e m√∫sica cl√°ssica.">
        <meta property="twitter:image" content="https://www.paroquiaauxiliadorairai.com.br/images/twitter-image.jpg"> <!-- Substitua pela URL da sua imagem -->

        <!-- Favicon -->
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">

        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background-color: #f4f7f6;
                color: #333;
                margin: 0;
                padding: 20px;
                display: flex;
                justify-content: center;
                align-items: flex-start; /* Alinhado ao topo para melhor visualiza√ß√£o */
                min-height: 100vh;
                box-sizing: border-box;
            }
            .radio-container {
                background-color: #ffffff;
                border-radius: 12px;
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
                padding: 30px;
                width: 100%;
                max-width: 450px;
                text-align: center;
                border: 1px solid #e0e0e0;
            }
            .radio-header {
                margin-bottom: 25px;
            }
            .radio-header h1 {
                color: #2c3e50;
                font-size: 1.8em;
                margin-bottom: 10px;
                font-weight: 600;
            }
            .radio-header p {
                color: #7f8c8d;
                font-size: 0.95em;
                line-height: 1.5;
            }
            .player-controls {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 15px;
                margin-bottom: 25px;
            }
            .player-controls button {
                background-color: #3498db;
                color: white;
                border: none;
                border-radius: 50%;
                width: 60px;
                height: 60px;
                font-size: 1.8em;
                cursor: pointer;
                transition: background-color 0.3s ease, transform 0.2s ease;
                display: flex;
                justify-content: center;
                align-items: center;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            }
            .player-controls button:hover:not(:disabled) {
                background-color: #2980b9;
                transform: translateY(-2px);
            }
            .player-controls button:disabled {
                background-color: #cccccc;
                cursor: not-allowed;
                box-shadow: none;
            }
            .volume-control {
                display: flex;
                align-items: center;
                gap: 10px;
                margin-top: 15px;
                justify-content: center;
            }
            .volume-control input[type="range"] {
                width: 120px;
                -webkit-appearance: none;
                height: 6px;
                background: #ddd;
                border-radius: 3px;
                outline: none;
                transition: opacity .2s;
            }
            .volume-control input[type="range"]::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 18px;
                height: 18px;
                border-radius: 50%;
                background: #3498db;
                cursor: pointer;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            }
            .volume-control input[type="range"]::-moz-range-thumb {
                width: 18px;
                height: 18px;
                border-radius: 50%;
                background: #3498db;
                cursor: pointer;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            }
            .status-area {
                margin-top: 20px;
                font-size: 0.9em;
                color: #555;
            }
            .current-stream-description {
                font-weight: bold;
                color: #2c3e50;
                margin-bottom: 5px;
            }
            .radio-status {
                font-style: italic;
                color: #7f8c8d;
            }
            .listeners-count {
                margin-top: 10px;
                font-size: 0.85em;
                color: #95a5a6;
            }
            .message-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                opacity: 0;
                visibility: hidden;
                transition: opacity 0.3s ease, visibility 0.3s ease;
            }
            .message-overlay.active {
                opacity: 1;
                visibility: visible;
            }
            .message-content {
                background-color: #ffffff;
                padding: 30px;
                border-radius: 10px;
                text-align: center;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                max-width: 80%;
                position: relative;
            }
            .message-content h2 {
                color: #3498db;
                margin-bottom: 15px;
            }
            .message-content p {
                font-size: 1.1em;
                color: #333;
                margin-bottom: 20px;
            }
            .message-content button {
                background-color: #e74c3c;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 1em;
                transition: background-color 0.3s ease;
            }
            .message-content button:hover {
                background-color: #c0392b;
            }
        </style>
    </head>
    <body>
        <div class="radio-container">
            <div class="radio-header">
                <h1>WebR√°dio Par√≥quia NSA</h1>
                <p>Sua companhia de f√© e m√∫sica.</p>
            </div>

            <div class="player-controls">
                <button id="playButton" title="Reproduzir" disabled>‚ñ∂</button>
                <button id="pauseButton" title="Pausar" disabled>‚è∏</button>
                <button id="stopButton" title="Parar" disabled>‚èπ</button>
            </div>

            <div class="volume-control">
                <span class="volume-icon">üîä</span>
                <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.7">
            </div>

            <div class="status-area">
                <div class="current-stream-description" id="currentStreamDescription">Carregando programa√ß√£o...</div>
                <div class="radio-status" id="radioStatus">Conectando ao servidor...</div>
                <div class="listeners-count">Ouvintes: <span id="listenersCount">0</span></div>
            </div>
        </div>

        <!-- Overlay para mensagens -->
        <div class="message-overlay" id="messageOverlay">
            <div class="message-content">
                <h2>Mensagem Especial</h2>
                <p id="messageText">Tocando uma mensagem importante...</p>
                <audio id="messagePlayer" preload="auto"></audio>
                <button id="closeMessageButton">Fechar Mensagem</button>
            </div>
        </div>

        <audio id="audioPlayer" preload="auto"></audio>

        <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
        <script>
            (function() {
                const socket = io();
                const audioPlayer = document.getElementById('audioPlayer');
                const messagePlayer = document.getElementById('messagePlayer');
                const playButton = document.getElementById('playButton');
                const pauseButton = document.getElementById('pauseButton');
                const stopButton = document.getElementById('stopButton');
                const volumeSlider = document.getElementById('volumeSlider');
                const currentStreamDescription = document.getElementById('currentStreamDescription');
                const radioStatus = document.getElementById('radioStatus');
                const listenersCount = document.getElementById('listenersCount');
                const messageOverlay = document.getElementById('messageOverlay');
                const messageText = document.getElementById('messageText');
                const closeMessageButton = document.getElementById('closeMessageButton');

                let isPlayingMessage = false; // Flag para controlar se uma mensagem est√° tocando

                // Inicializa o volume
                audioPlayer.volume = volumeSlider.value;
                messagePlayer.volume = volumeSlider.value;

                volumeSlider.addEventListener('input', () => {
                    audioPlayer.volume = volumeSlider.value;
                    messagePlayer.volume = volumeSlider.value;
                });

                // Controles do player principal
                playButton.addEventListener('click', () => {
                    if (isPlayingMessage) {
                        messagePlayer.play().then(() => {
                            console.log('‚ñ∂Ô∏è Mensagem retomada manualmente.');
                            playButton.disabled = true;
                            pauseButton.disabled = false;
                            radioStatus.textContent = 'Mensagem';
                        }).catch(error => {
                            console.error('‚ùå Erro ao retomar mensagem:', error);
                            radioStatus.textContent = 'Erro ao tocar mensagem.';
                        });
                    } else {
                        audioPlayer.play().then(() => {
                            console.log('‚ñ∂Ô∏è Stream principal iniciado manualmente.');
                            playButton.disabled = true;
                            pauseButton.disabled = false;
                            radioStatus.textContent = 'Reproduzindo';
                        }).catch(error => {
                            console.error('‚ùå Erro ao iniciar stream principal:', error);
                            radioStatus.textContent = 'Erro ao tocar r√°dio.';
                        });
                    }
                });

                pauseButton.addEventListener('click', () => {
                    if (isPlayingMessage) {
                        messagePlayer.pause();
                        console.log('‚è∏Ô∏è Mensagem pausada manualmente.');
                        radioStatus.textContent = 'Mensagem Pausada';
                    } else {
                        audioPlayer.pause();
                        console.log('‚è∏Ô∏è Stream principal pausado manualmente.');
                        radioStatus.textContent = 'Pausado';
                    }
                    playButton.disabled = false;
                    pauseButton.disabled = true;
                });

                stopButton.addEventListener('click', () => {
                    audioPlayer.pause();
                    audioPlayer.src = ''; // Limpa a fonte para parar completamente
                    messagePlayer.pause();
                    messagePlayer.src = '';
                    isPlayingMessage = false;
                    messageOverlay.classList.remove('active');
                    console.log('‚èπÔ∏è R√°dio parada completamente.');
                    playButton.disabled = false;
                    pauseButton.disabled = true;
                    radioStatus.textContent = 'Parado';
                    currentStreamDescription.textContent = 'R√°dio Inativa';
                });

                // Eventos do Socket.IO
                socket.on('connect', () => {
                    console.log('‚úÖ Conectado ao servidor Socket.IO');
                    radioStatus.textContent = 'Conectado. Aguardando programa√ß√£o...';
                    // Habilita o bot√£o de play assim que conectar, para o usu√°rio poder tentar iniciar
                    playButton.disabled = false;
                    pauseButton.disabled = true;
                    stopButton.disabled = false;
                });

                socket.on('disconnect', () => {
                    console.log('‚ùå Desconectado do servidor Socket.IO');
                    radioStatus.textContent = 'Desconectado. Tentando reconectar...';
                    playButton.disabled = true;
                    pauseButton.disabled = true;
                    stopButton.disabled = true;
                });

                socket.on('play-stream', (data) => {
                    console.log('üîÑ Recebido comando play-stream:', data);
                    isPlayingMessage = false;
                    messageOverlay.classList.remove('active'); // Garante que o overlay da mensagem esteja oculto

                    currentStreamDescription.textContent = data.description;
                    audioPlayer.src = data.url;

                    // Tenta tocar automaticamente. Se falhar (autoplay bloqueado), o usu√°rio precisar√° clicar no play.
                    audioPlayer.load(); // Recarrega o stream
                    audioPlayer.play().then(() => {
                        console.log('‚ñ∂Ô∏è Stream principal iniciado automaticamente.');
                        playButton.disabled = true;
                        pauseButton.disabled = false;
                        radioStatus.textContent = 'Reproduzindo';
                    }).catch(error => {
                        console.warn('‚ö†Ô∏è Autoplay bloqueado ou erro ao iniciar stream principal:', error);
                        radioStatus.textContent = 'Pausado. Clique no ‚ñ∂ para iniciar.';
                        playButton.disabled = false;
                        pauseButton.disabled = true;
                    });
                });

                socket.on('play-mensagem', (data) => {
                    console.log('üì¢ Recebido comando play-mensagem:', data);
                    isPlayingMessage = true;
                    currentStreamDescription.textContent = `Mensagem: ${data.nome}`;
                    messageText.textContent = `Tocando: ${data.nome}`;
                    messagePlayer.src = data.arquivo;
                    messageOverlay.classList.add('active'); // Mostra o overlay

                    // Pausa o stream principal e tenta tocar a mensagem
                    audioPlayer.pause();
                    messagePlayer.load(); // Recarrega a mensagem
                    messagePlayer.play().then(() => {
                        console.log('‚ñ∂Ô∏è Mensagem iniciada automaticamente.');
                        playButton.disabled = true;
                        pauseButton.disabled = false;
                        radioStatus.textContent = 'Mensagem';
                    }).catch(error => {
                        console.warn('‚ö†Ô∏è Autoplay bloqueado ou erro ao iniciar mensagem:', error);
                        radioStatus.textContent = 'Mensagem. Clique no ‚ñ∂ para iniciar.';
                        playButton.disabled = false;
                        pauseButton.disabled = true;
                        // Se a mensagem n√£o tocar, o timeout no servidor ainda vai retornar para a r√°dio principal
                    });

                    // Quando a mensagem terminar, o servidor enviar√° um novo 'play-stream'
                    messagePlayer.onended = () => {
                        console.log('‚èπÔ∏è Mensagem finalizada pelo player.');
                        messageOverlay.classList.remove('active');
                        isPlayingMessage = false;
                        // O servidor j√° vai enviar o comando para retomar a r√°dio principal
                    };
                });

                socket.on('listeners-update', (count) => {
                    listenersCount.textContent = count;
                });

                // Evento para fechar o overlay da mensagem (opcional, a mensagem termina sozinha)
                closeMessageButton.addEventListener('click', () => {
                    messageOverlay.classList.remove('active');
                    // Se o usu√°rio fechar manualmente, ainda esperamos o servidor para retomar a r√°dio
                });

                // Eventos do √°udio principal
                audioPlayer.addEventListener('error', (e) => {
                    console.error('‚ùå Erro no √°udio principal:', audioPlayer.error);
                    let errorMsg = 'Erro desconhecido no stream principal';
                    if (audioPlayer.error) {
                        const errorCodes = ['', 'Abortado', 'Erro de rede', 'Erro de decodifica√ß√£o', 'Formato n√£o suportado'];
                        errorMsg = errorCodes[audioPlayer.error.code] || 'Erro ' + audioPlayer.error.code;
                    }
                    radioStatus.textContent = errorMsg;
                    playButton.disabled = false;
                    pauseButton.disabled = true;
                    isPlayingMessage = false;
                    messageOverlay.classList.remove('active');
                    socket.emit('check-stream-status'); // Pede para o servidor retornar ao stream principal
                });

                audioPlayer.addEventListener('canplay', () => {
                    console.log('‚úÖ Stream principal pronto para tocar');
                });

                audioPlayer.addEventListener('playing', () => {
                    console.log('‚ñ∂Ô∏è Reproduzindo stream principal');
                    if (!isPlayingMessage) {
                        playButton.disabled = true;
                        pauseButton.disabled = false;
                        radioStatus.textContent = 'Reproduzindo';
                    }
                });

                audioPlayer.addEventListener('pause', () => {
                    console.log('‚è∏Ô∏è Pausado stream principal');
                    if (!isPlayingMessage) {
                        playButton.disabled = false;
                        pauseButton.disabled = true;
                        radioStatus.textContent = 'Pausado';
                    }
                });

                audioPlayer.addEventListener('waiting', () => {
                    console.log('‚è≥ Buffering stream principal...');
                    radioStatus.textContent = 'Carregando...';
                });

                // Eventos do player de mensagem
                messagePlayer.addEventListener('error', (e) => {
                    console.error('‚ùå Erro no √°udio da mensagem:', messagePlayer.error);
                    let errorMsg = 'Erro desconhecido na mensagem';
                    if (messagePlayer.error) {
                        const errorCodes = ['', 'Abortado', 'Erro de rede', 'Erro de decodifica√ß√£o', 'Formato n√£o suportado'];
                        errorMsg = errorCodes[messagePlayer.error.code] || 'Erro ' + messagePlayer.error.code;
                    }
                    radioStatus.textContent = errorMsg;
                    messageOverlay.classList.remove('active');
                    isPlayingMessage = false;
                    socket.emit('check-stream-status'); // Pede para o servidor retornar ao stream principal
                });

                messagePlayer.addEventListener('playing', () => {
                    console.log('‚ñ∂Ô∏è Reproduzindo mensagem');
                    playButton.disabled = true;
                    pauseButton.disabled = false;
                    radioStatus.textContent = 'Mensagem';
                });

                messagePlayer.addEventListener('pause', () => {
                    console.log('‚è∏Ô∏è Pausado mensagem');
                    playButton.disabled = false;
                    pauseButton.disabled = true;
                    radioStatus.textContent = 'Mensagem Pausada';
                });

                console.log('‚úÖ WebR√°dio Player inicializado');
            })();
        </script>
    </body>
    </html>
